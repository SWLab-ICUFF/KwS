prefix : <urn:vocab:kws:>
prefix kws: <urn:vocab:kws:>
prefix kwsg: <urn:graph:kws:>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix meta: <http://www.semwebtech.org/mondial/10/meta#>
prefix text: <http://jena.apache.org/text#>
prefix xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX fn: <java:uff.ic.swlab.jena.sparql.>

select ?g1 ?g2 (min(?count) as ?ref) (count(?exists) as ?found)
where {
  service <http://localhost:3030/Mondial.benchmark/sparql> {
    graph ?g1 {?s ?p ?o}
    filter (regex(str(?g1),"urn:graph:kws:043:"))
  }
  {
    select distinct ?g2
    where {
      graph ?g2 {[] ?_p [].}
      filter (regex(str(?g2),"urn:graph:kws:043:"))
    }
  }
  {
    select ?g1 (count(*) as ?count)
    where {
      service <http://localhost:3030/Mondial.benchmark/sparql> {
        graph ?g1 {[] ?_p [].} filter (regex(str(?g1),"urn:graph:kws:043:"))
      }
    }
    group by ?g1
  }
  filter (exists {graph ?g2 {?s ?p ?o.}})
}
group by ?g1 ?g2
